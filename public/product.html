<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Sree Vidyadhiraja Foundation - Campaign</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&family=Pacifico&display=swap" rel="stylesheet">

  <!-- Icons & Bootstrap -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
  <link href="css/bootstrap.min.css" rel="stylesheet">

  <!-- Libraries -->
  <link href="lib/animate/animate.min.css" rel="stylesheet">
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

  <!-- Template CSS -->
  <link href="css/style.css" rel="stylesheet">

  <style>
    /* Orange Theme */
    .bg-primary { background-color: #ff6f00 !important; }
    .btn-primary { background-color: #ff6f00; border-color: #ff6f00; }
    .btn-primary:hover { background-color: #e65a00; border-color: #e65a00; }
    .text-primary { color: #ff6f00 !important; }
    .product-badge { background-color: #ff6f00 !important; color: #fff !important; }

    /* Scrollable description */
    .full-desc {
      max-height: 120px;
      overflow-y: auto;
      display: none;
      padding-right: 5px;
    }
    .full-desc::-webkit-scrollbar { width: 6px; }
    .full-desc::-webkit-scrollbar-thumb { background: #ff6f00; border-radius: 10px; }

    /* Make card clickable */
    .blog-item {
      cursor: pointer;
      transition: transform 0.2s ease-in-out;
    }
    .blog-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.1);
    }
  </style>
</head>

<body>
  <!-- Navbar, Hero, and Footer remain unchanged (same as before) -->

  <!-- Campaign Section -->
  <div class="container-fluid py-5">
    <div class="container py-5">
      <h1 class="display-3 mb-5 wow fadeIn" data-wow-delay="0.1s">
        Explore <span class="text-primary">Our Campaign</span>
      </h1>
      <div class="row g-4 justify-content-center" id="productContainer">
        <!-- Campaigns will be injected here dynamically -->
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="lib/wow/wow.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="js/main.js"></script>

  <!-- Firebase Campaign Fetch -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCxzn7eUe9QRa0sjLp4v6rS2RJU_cRCtkg",
      authDomain: "vidyadhiraja-b6ec5.firebaseapp.com",
      projectId: "vidyadhiraja-b6ec5",
      storageBucket: "vidyadhiraja-b6ec5.firebasestorage.app",
      messagingSenderId: "1018541742665",
      appId: "1:1018541742665:web:4ded9d4c51d33edd203d98"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const productContainer = document.getElementById("productContainer");

    async function loadProducts() {
      const querySnapshot = await getDocs(collection(db, "products"));
      productContainer.innerHTML = "";
      querySnapshot.forEach((docSnap, i) => {
        const product = docSnap.data();
        productContainer.innerHTML += `
          <div class="col-lg-6 col-xl-4">
            <div class="blog-item wow fadeIn" data-wow-delay="${0.1 * (i+1)}s" data-url="${product.url}">
              <div class="blog-img position-relative overflow-hidden">
                <img src="${product.image}" class="img-fluid w-100" alt="${product.title}">
                <div class="product-badge d-inline px-3 py-2 text-center position-absolute top-0 end-0">Campaign</div>
              </div>
              <div class="p-4">
                <h4 class="lh-sm mb-3">${product.title}</h4>
                <p class="mb-4 short-desc">${product.description.substring(0,100)}...</p>
                <p class="mb-4 full-desc">${product.description}</p>
                <button class="btn btn-primary px-3 toggle-details" data-id="${docSnap.id}">More Details</button>
              </div>
            </div>
          </div>
        `;
      });
    }

    loadProducts();

    // Make card clickable
    document.addEventListener("click", function(e) {
      const card = e.target.closest(".blog-item");
      if (card && !e.target.classList.contains("toggle-details")) {
        const url = card.getAttribute("data-url");
        if (url) window.location.href = url;
      }
    });

    // Toggle expand/collapse for description
    document.addEventListener("click", function(e) {
      if (e.target && e.target.classList.contains("toggle-details")) {
        e.stopPropagation(); // prevent triggering card redirect
        const card = e.target.closest(".blog-item");
        const shortDesc = card.querySelector(".short-desc");
        const fullDesc = card.querySelector(".full-desc");

        if (fullDesc.style.display === "none" || fullDesc.style.display === "") {
          shortDesc.style.display = "none";
          fullDesc.style.display = "block";
          e.target.textContent = "Show Less";
        } else {
          shortDesc.style.display = "block";
          fullDesc.style.display = "none";
          e.target.textContent = "More Details";
        }
      }
    });
  </script>
</body>
</html>
